<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TELOC Cell | SECR Raipur Division</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:"Segoe UI",Arial,sans-serif;background:linear-gradient(120deg,#eef3f9,#f8fbff); min-height: 100vh; position: relative;}

header{max-width:1200px;margin:12px auto 0;background:linear-gradient(90deg,#0b3c6d,#1e6fa8);border-radius:14px}
.header-wrap{display:flex;align-items:center;justify-content: center; gap:20px;padding:12px 16px}
.header-wrap img{height:110px}
.header-text{text-align:center;color:#fff}
.header-text h1{margin:0;font-size:28px;font-weight:800}
.header-text h2{margin:2px 0;font-size:22px;font-weight:700}
.header-text h3{margin:2px 0;font-size:16px;font-weight:600;color:#ffffff}
.header-text h4{margin:0;font-size:14px;font-weight:500}

.container{max-width:1200px;margin:10px auto;padding:10px 16px 80px} /* Added bottom padding for watermark */
.card{background:#f4f8ff;padding:22px;border-radius:14px;box-shadow:0 10px 25px rgba(0,0,0,.12)}

h3{margin-top:0;color:#0b3c6d;font-size:22px}

/* Sudhar: Input blocks spacing and max-width */
.row-date, .row-journey, .row-station, .row-train, .row-crew, .row-upload {
    gap: 25px; /* Spacing increased */
    margin-bottom: 20px; /* Vertical gap between rows */
}

.row-date{display:grid;grid-template-columns:150px 150px 1fr;}
.row-journey{display:grid;grid-template-columns:repeat(2, 250px);}
.row-station{display:grid;grid-template-columns:repeat(2, 200px);}
.row-train{display:grid;grid-template-columns:250px 150px 150px;}
.row-crew{display:grid;grid-template-columns:120px 250px 120px 120px;}
.row-upload{display:grid;grid-template-columns:repeat(2, 250px);}

label{font-weight:800;color:#1f2937;font-size:14px; display: block; margin-bottom: 5px;}

input,select{width:100%;padding:10px 12px;border-radius:8px;border:2px solid #cbd5e1;font-size:14px;font-weight:700;background:#ffffff;transition:all .2s ease; box-sizing: border-box;}

input[disabled]{font-weight:800;color:#111827;background:#eef4ff}
input:not(:placeholder-shown), select:not([value=""]){background:#e8f1ff}
input:focus,select:focus{outline:none;border-color:#2563eb;background:#e0ecff}

.upload-received{border-color:#16a34a !important;background:#dcfce7 !important}

.spacer{height:5px} /* Reduced as margin-bottom is added to rows */
button{margin-top:26px;padding:14px 32px;background:linear-gradient(90deg,#2563eb,#1e40af);color:#fff;border:none;border-radius:30px;font-size:16px;font-weight:800;cursor:pointer}
button:hover{transform:scale(1.02)}
small{color:#374151;font-weight:600}

/* Sudhar: Watermark style */
.watermark {
    position: fixed;
    bottom: 10px;
    right: 20px;
    font-size: 11px;
    color: #cbd5e1; /* Background se milta julta */
    font-weight: 700;
    pointer-events: none;
    user-select: none;
    opacity: 0.6;
}
</style>
</head>

<body>
<header>
  <div class="header-wrap">
    <img src="masters/IR_LOGO.png" alt="IR Logo">
    <div class="header-text">
      <h1>South East Central Railway</h1>
      <h2>Raipur Division</h2>
      <h3>Electrical (OP) Department</h3>
      <h4>TELOC Cell</h4>
    </div>
  </div>
</header>

<div class="container">
  <div class="card">
    <h3>CLI Input Form</h3>

    <div class="row-date">
      <div><label>Date</label><input type="date" id="today"></div>
      <div><label>CLI ID</label><input id="cli_id" placeholder="R0045"></div>
      <div><label>CLI Name</label><input id="cli_name" disabled></div>
    </div>

    <div class="row-journey">
      <div><label>Journey From</label><input type="datetime-local" id="journey_from"></div>
      <div><label>Journey To</label><input type="datetime-local" id="journey_to"></div>
    </div>

    <div class="row-station">
      <div><label>From Station Code</label><input id="from_code"></div>
      <div><label>To Station Code</label><input id="to_code"></div>
    </div>

    <div class="row-station">
      <div><label>From Station Name</label><input id="from_name" disabled></div>
      <div><label>To Station Name</label><input id="to_name" disabled></div>
    </div>

    <div class="row-train">
      <div><label>Train Name / Number</label><input id="train_no"></div>
      <div>
        <label>Train Type</label>
        <select id="train_type">
          <option value="">Select</option>
          <option>Goods</option><option>Coaching</option><option>Passenger</option><option>MEMU</option><option>VB</option>
        </select>
      </div>
      <div>
        <label>Train MPS</label>
        <select id="train_mps">
          <option value="">Select</option>
          <option>40</option><option>45</option><option>50</option><option>55</option>
          <option>60</option><option>65</option><option>70</option><option>75</option>
          <option>80</option><option>85</option><option>90</option><option>95</option>
          <option>100</option><option>105</option><option>110</option><option>115</option>
          <option>120</option><option>125</option><option>130</option><option>135</option><option>140</option>
        </select>
      </div>
    </div>

    <div class="row-crew">
      <div><label>LP ID</label><input id="lp_id"></div>
      <div><label>LP Name</label><input id="lp_name" disabled></div>
      <div><label>Designation</label><input id="lp_desg" disabled></div>
      <div><label>G_CLI</label><input id="lp_gcli" disabled></div>
    </div>

    <div class="row-crew">
      <div><label>ALP ID</label><input id="alp_id"></div>
      <div><label>ALP Name</label><input id="alp_name" disabled></div>
      <div><label>Designation</label><input id="alp_desg" disabled></div>
      <div><label>G_CLI</label><input id="alp_gcli" disabled></div>
    </div>

    <div class="row-upload">
      <div>
        <label>RTIS Data (CSV)</label>
        <input type="file" id="rtis_file" accept=".csv">
        <small id="rtis_status">Choose File</small>
      </div>
      <div>
        <label>Caution Order</label>
        <input type="file" id="caution_file" accept=".pdf,.jpg,.jpeg,.png,.csv">
        <small id="caution_status">Choose File</small>
      </div>
    </div>

    <button onclick="generateReport()">Generate Report</button>

  </div>
</div>

<div class="watermark">CLI/TELOC-M LACHHWANI</div>

<script>
let cliMap={},stationMap={},crewMap={},mastersLoaded=false;
let rtisFile=null,cautionFile=null;

async function loadCSV(path){const r=await fetch(path);const t=await r.text();return t.trim().split(/\r?\n/).map(l=>l.split(',').map(c=>c.trim()))}

async function loadMasters(){
  try {
    (await loadCSV('masters/cli_master.csv')).slice(1).forEach(r=>{if(r[0])cliMap[r[0].toUpperCase()]=r[1]});
    (await loadCSV('masters/station_master.csv')).slice(1).forEach(r=>{if(r[0])stationMap[r[0].toUpperCase()]=r[1]});
    (await loadCSV('masters/crew_master.csv')).slice(1).forEach(r=>{if(r[0])crewMap[r[0].toUpperCase()]={name:r[1],desg:r[2],gcli:r[3]}});
    mastersLoaded=true;
  } catch(e) { console.error("Master files not found"); }
}
loadMasters();

function waitForMasters(cb){mastersLoaded?cb():setTimeout(()=>waitForMasters(cb),100)}

cli_id.oninput=()=>waitForMasters(()=>cli_name.value=cliMap[cli_id.value.trim().toUpperCase()]||'');
from_code.oninput=()=>waitForMasters(()=>from_name.value=stationMap[from_code.value.trim().toUpperCase()]||'');
to_code.oninput=()=>waitForMasters(()=>to_name.value=stationMap[to_code.value.trim().toUpperCase()]||'');

lp_id.oninput=()=>waitForMasters(()=>{const d=crewMap[lp_id.value.trim().toUpperCase()];lp_name.value=d?d.name:'';lp_desg.value=d?d.desg:'';lp_gcli.value=d?d.gcli:''});
alp_id.oninput=()=>waitForMasters(()=>{const d=crewMap[alp_id.value.trim().toUpperCase()];alp_name.value=d?d.name:'';alp_desg.value=d?d.desg:'';alp_gcli.value=d?d.gcli:''});

document.addEventListener('DOMContentLoaded',()=>{
  today.value=new Date().toISOString().slice(0,10);
  const now=new Date().toISOString().slice(0,16);
  journey_from.max=now;journey_to.max=now;
  journey_from.addEventListener('change',()=>{ journey_to.min = journey_from.value; });
});

rtis_file.onchange=e=>{rtisFile=e.target.files[0]||null;if(rtisFile){rtis_file.classList.add('upload-received');rtis_status.textContent='Received'}};
caution_file.onchange=e=>{cautionFile=e.target.files[0]||null;if(cautionFile){caution_file.classList.add('upload-received');caution_status.textContent='Received'}};

function generateReport(){if(!rtisFile||!cautionFile){alert('RTIS Data aur Caution Order dono upload karna mandatory hai');return}alert('Final inputs OK. Home page locked.')}
</script>
</body>
</html>
